<div class="projects-container">
  <div class="projects-header">
    <h1>Projects</h1>
    <%= link_to '+ Create', new_project_path, class: 'btn-create' %>
  </div>
  
  <% if flash[:notice] %>
    <div class="alert alert-success"><%= flash[:notice] %></div>
  <% end %>
  
  <% if flash[:error] %>
    <div class="alert alert-danger"><%= flash[:error] %></div>
  <% end %>
  
  <% max_steps = max_steps_count(@projects_by_category.values.flatten) %>
  
  <!-- Current Projects -->
  <% if @projects_by_category[:current].present? && @projects_by_category[:current].any? %>
    <div class="projects-section">
      <h2 class="section-title">Current Projects</h2>
      <table class="projects-table">
        <thead>
          <tr>
            <th class="col-project-name">Project Name</th>
            <% (1..max_steps).each do |step_num| %>
              <th class="col-step">STEP <%= step_num %></th>
            <% end %>
          </tr>
        </thead>
        <tbody>
          <% @projects_by_category[:current].each do |project| %>
            <%= render partial: 'project_row', locals: { project: project, max_steps: max_steps, category: 'current' } %>
          <% end %>
        </tbody>
      </table>
    </div>
  <% end %>
  
  <!-- Upcoming Projects -->
  <% if @projects_by_category[:upcoming].present? && @projects_by_category[:upcoming].any? %>
    <div class="projects-section">
      <h2 class="section-title">Upcoming Projects</h2>
      <table class="projects-table">
        <thead>
          <tr>
            <th class="col-project-name">Project Name</th>
            <% (1..max_steps).each do |step_num| %>
              <th class="col-step">STEP <%= step_num %></th>
            <% end %>
          </tr>
        </thead>
        <tbody>
          <% @projects_by_category[:upcoming].each do |project| %>
            <%= render partial: 'project_row', locals: { project: project, max_steps: max_steps, category: 'upcoming' } %>
          <% end %>
        </tbody>
      </table>
    </div>
  <% end %>
  
  <!-- Past Projects -->
  <% if @projects_by_category[:past].present? && @projects_by_category[:past].any? %>
    <div class="projects-section">
      <h2 class="section-title">Past Projects</h2>
      <table class="projects-table">
        <thead>
          <tr>
            <th class="col-project-name">Project Name</th>
            <% (1..max_steps).each do |step_num| %>
              <th class="col-step">STEP <%= step_num %></th>
            <% end %>
          </tr>
        </thead>
        <tbody>
          <% @projects_by_category[:past].each do |project| %>
            <%= render partial: 'project_row', locals: { project: project, max_steps: max_steps, category: 'past' } %>
          <% end %>
        </tbody>
      </table>
    </div>
  <% end %>
  
  <!-- Unpublished Projects -->
  <% if @projects_by_category[:unpublished].present? && @projects_by_category[:unpublished].any? %>
    <div class="projects-section">
      <h2 class="section-title">Unpublished Projects</h2>
      <table class="projects-table">
        <thead>
          <tr>
            <th class="col-project-name">Project Name</th>
            <% (1..max_steps).each do |step_num| %>
              <th class="col-step">STEP <%= step_num %></th>
            <% end %>
          </tr>
        </thead>
        <tbody>
          <% @projects_by_category[:unpublished].each do |project| %>
            <%= render partial: 'project_row', locals: { project: project, max_steps: max_steps, category: 'unpublished' } %>
          <% end %>
        </tbody>
      </table>
    </div>
  <% end %>
  
  <!-- Empty State -->
  <% if @projects_by_category.values.flatten.empty? %>
    <div class="empty-state">
      <div class="empty-state-icon">üìã</div>
      <p>ÌîÑÎ°úÏ†ùÌä∏Í∞Ä ÏóÜÏäµÎãàÎã§.</p>
      <%= link_to 'ÏÉà ÌîÑÎ°úÏ†ùÌä∏Î•º ÏÉùÏÑ±', new_project_path, class: 'btn-create' %>Ìï¥Î≥¥ÏÑ∏Ïöî.
    </div>
  <% end %>
</div>

<style>
  .projects-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 2rem;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  }
  
  .projects-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 2px solid #0d6efd;
  }
  
  .projects-header h1 {
    font-size: 2rem;
    font-weight: 600;
    color: #212529;
    margin: 0;
  }
  
  .btn-create {
    background-color: #0d6efd;
    color: white;
    padding: 0.5rem 1.25rem;
    border-radius: 0.375rem;
    text-decoration: none;
    font-weight: 500;
    transition: background-color 0.2s;
  }
  
  .btn-create:hover {
    background-color: #0b5ed7;
    color: white;
  }
  
  .projects-section {
    margin-bottom: 3rem;
  }
  
  .section-title {
    font-size: 1.25rem;
    font-weight: 600;
    color: #212529;
    margin-bottom: 1rem;
  }
  
  .projects-table {
    width: 100%;
    border-collapse: collapse;
    background-color: white;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  }
  
  .projects-table thead {
    background-color: #f0f0f0;
  }
  
  .projects-table th {
    padding: 0.75rem 1rem;
    text-align: left;
    font-weight: 600;
    font-size: 0.875rem;
    color: #495057;
    border-bottom: 2px solid #dee2e6;
  }
  
  .projects-table td {
    padding: 1rem;
    border-bottom: 1px solid #e9ecef;
    vertical-align: top;
  }
  
  .projects-table tbody tr:hover {
    background-color: #f8f9fa;
  }
  
  .col-project-name {
    min-width: 200px;
    width: 25%;
  }
  
  .col-step {
    min-width: 180px;
    width: calc(75% / <%= max_steps_count(@projects_by_category.values.flatten) %>);
  }
  
  .project-name-cell {
    font-weight: 600;
    color: #212529;
  }
  
  .project-name-cell a {
    color: #212529;
    text-decoration: none;
  }
  
  .project-name-cell a:hover {
    color: #0d6efd;
    text-decoration: underline;
  }
  
  .project-date-info {
    font-size: 0.75rem;
    color: #6c757d;
    margin-top: 0.25rem;
  }
  
  .step-cell {
    min-height: 80px;
  }
  
  .step-content {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .step-icons {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .step-icon {
    width: 20px;
    height: 20px;
    cursor: pointer;
    opacity: 0.6;
  }
  
  .step-icon:hover {
    opacity: 1;
  }
  
  .step-due-date {
    font-size: 0.75rem;
    color: #495057;
    font-weight: 500;
  }
  
  .step-badges {
    display: flex;
    flex-wrap: wrap;
    gap: 0.375rem;
  }
  
  .badge {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.25rem 0.5rem;
    border-radius: 0.25rem;
    font-size: 0.75rem;
    font-weight: 500;
  }
  
  .badge-current {
    background-color: #e9ecef;
    color: #495057;
  }
  
  .badge-past {
    background-color: #e9ecef;
    color: #6c757d;
  }
  
  .badge-upcoming {
    background-color: #fff3cd;
    color: #856404;
  }
  
  .badge-needs-grading {
    background-color: #fff3cd;
    color: #ff8c00;
  }
  
  .badge-needs-grading::before {
    content: "‚úèÔ∏è";
    font-size: 0.875rem;
  }
  
  .badge-submitted {
    background-color: #d1e7dd;
    color: #0f5132;
  }
  
  .badge-not-submitted {
    background-color: #fff3cd;
    color: #856404;
  }
  
  .badge-empty {
    color: #adb5bd;
    font-style: italic;
  }
  
  .project-actions {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.5rem;
  }
  
  .btn-action {
    padding: 0.25rem 0.5rem;
    border-radius: 0.25rem;
    text-decoration: none;
    font-size: 0.75rem;
    border: 1px solid;
    transition: all 0.2s;
  }
  
  .btn-view {
    background-color: #0d6efd;
    color: white;
    border-color: #0d6efd;
  }
  
  .btn-view:hover {
    background-color: #0b5ed7;
    color: white;
  }
  
  .btn-edit {
    background-color: white;
    color: #6c757d;
    border-color: #6c757d;
  }
  
  .btn-edit:hover {
    background-color: #6c757d;
    color: white;
  }
  
  .btn-delete {
    background-color: white;
    color: #dc3545;
    border-color: #dc3545;
  }
  
  .btn-delete:hover {
    background-color: #dc3545;
    color: white;
  }
  
  .empty-state {
    text-align: center;
    padding: 4rem 2rem;
    color: #6c757d;
  }
  
  .empty-state-icon {
    font-size: 4rem;
    margin-bottom: 1rem;
    opacity: 0.5;
  }
  
  .alert {
    padding: 0.75rem 1rem;
    border-radius: 0.375rem;
    margin-bottom: 1.5rem;
  }
  
  .alert-success {
    background-color: #d1e7dd;
    color: #0f5132;
    border: 1px solid #badbcc;
  }
  
  .alert-danger {
    background-color: #f8d7da;
    color: #842029;
    border: 1px solid #f5c2c7;
  }
</style>
